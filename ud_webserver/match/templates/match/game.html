{% load static %}
<document>
	<head>
		<script
			src="https://code.jquery.com/jquery-3.7.1.min.js"
			integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
			crossorigin="anonymous"
		></script>
		<script src="{% static 'match/game_files/a.out.js' %}"></script>
		<script>
			var game_module = null;

			function resize_js_callback(entries) {
				for (const resize_entry of entries) {
					requestAnimationFrame(() => {
						resize_entry.target.width =
							resize_entry.devicePixelContentBoxSize[0].inlineSize;
						resize_entry.target.height =
							resize_entry.devicePixelContentBoxSize[0].blockSize;

						if (game_module != null) {
							game_module.ccall(
								"resize_gl_viewport",
								null,
								["number", "number"],
								[
									resize_entry.target.width,
									resize_entry.target.height,
								],
							);
						}
					});
				}
			}
			$(function () {
				new ResizeObserver(resize_js_callback).observe(
					document.getElementById("game_canvas"),
					{ box: "device-pixel-content-box" },
				);

				Module({
					canvas: $("#game_canvas"),
				}).then((module) => {
					game_module = module;
				});
			});
		</script>
	</head>
	<canvas id="game_canvas" style="width: 100%; height: 100%"> </canvas>
</document>
